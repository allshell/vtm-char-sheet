# VtM 角色卡录入辅助工具 v_0.0.2

本工具专为《吸血鬼：避世潜藏》（Vampire: The Masquerade）玩家设计，旨在简化 **SealDice (海豹骰)** 相关插件的角色卡录入流程 。支持 V5 与 V20 双版本规则，并实现与 V5 自动 Excel 人物卡基本互通。

[点击此处直接使用](https://allshell.github.io/vtm-char-sheet/)

## 核心功能

* 
**双规则支持**：完整适配 VtM V5 与 V20 核心属性、技能系统。

* **Excel 智能同步 (仅限 V5)**：
* **一键导入**：支持读取《吸血鬼：避世潜藏5版半自动人物卡1.6.xlsm》中的属性、技能及 5 组自定义血律项目。
* **一键导出**：将网页修改后的数据写回原 Excel 模板（目前该工具不读写原表的公式与宏，因此导出功能仅建议作为暂存使用）。

* 
**指令自动生成**：根据填写内容自动生成 `.vst` 录卡指令，过滤 0 值，一键复制 。

* 
**灵活自定义**：支持手动添加、删除律能或其他自定义属性项目 。

## 使用说明

### 1. 模式选择

* 在页面顶部切换 **V5** 或 **V20** 模式 。

* **注意**：Excel 导入/导出功能目前仅针对上述版本的 V5 自动卡进行了坐标适配。

### 2. Excel 数据同步 (V5)

* **导入**：点击“导入 Excel”并选择填写好的 `.xlsm` 文件，系统将自动填充标准属性、技能及最多 5 组自定义血律。
* **导出**：在网页修改数据后，点击“导出 Excel”，系统会将当前数值写回模板并生成新的文件（目前该工具不读写原表的公式与宏，因此导出功能仅建议作为暂存使用）。

### 3. 指令同步至 SealDice

* 填写或核对完数据后，点击底部的 **“生成录卡指令”** 。


* 点击 **“复制指令”**，将其发送至安装了 `vtm.js` 插件的 SealDice 窗口即可完成录卡 。

## Excel 坐标映射参考 (V5)

本工具默认适配的自定义槽位如下：

* **标准属性/技能**：已根据 1.6 版半自动人物卡进行坐标预设。
* **自定义血律槽位 1-5 (名称)**：K14, K21, K28, K35, K42。
* **自定义血律槽位 1-5 (等级)**：K16, K23, K30, K37, K44。

## 依赖项

* **前端处理**：SheetJS (xlsx.full.min.js)。
* 
**骰子插件**：配套使用 `vtm.js` 以获得最佳的 `.va` 检定体验。
