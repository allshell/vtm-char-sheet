本项目包含两个主要工具：

1. [#VtM-骰子插件-v_1.8.5](https://github.com/allshell/vtm-char-sheet/tree/main?tab=readme-ov-file#vtm-%E9%AA%B0%E5%AD%90%E6%8F%92%E4%BB%B6-v_185)
2. [#与插件配套的录卡工具](https://github.com/allshell/vtm-char-sheet/tree/main?tab=readme-ov-file#vtm-%E8%A7%92%E8%89%B2%E5%8D%A1%E5%BD%95%E5%85%A5%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7-v_002)

# VtM 骰子插件 v_1.8.5

本插件为 **SealDice (海豹骰)** 核心配套插件。下载项目中的插件文件 `vtm_1.8.5.js`，使用海豹骰核心加载 JS 插件并启动后，即可按需激活使用。

本插件独有的VtM检定指令如下：

*请注意游玩版本差异，目前支持VtM5版及VtM20周年纪念版

- `.ext vtm on` 启动插件
- `.ext vtm off` 关闭插件

**简易掷骰**

`.vv 骰池k难度k饥渴` VtM第五版检定掷骰
- 例：玩家要使用血魔术技能吮血知味，骰池为智力+血魔术，难度为3。玩家的智力为4，血魔术等级为3，饥渴值为2，则输入指令为 `.vv 7k3k2`
- 支持多重投掷：`.vv 3#7k3k2` (重复3次)

`.vxx 骰池k难度` VtM20周年纪念版检定掷骰
- 例：玩家要使用支配术技能催眠，骰池为操纵+领导，难度为5（目标的意志点数）。玩家的操纵为4，领导为2，则输入指令为 `.vxx 6k5`
- 支持多重投掷：`.vxx 4#6k5` (重复4次)

**切换规则版本**
- `.vset` 查看当前规则（V5/V20）
- `.vset v5` 设置为V5规则（或 `.vset vv`）
- `.vset v20` 设置为V20规则（或 `.vset vxx`）

切换规则版本后可进行角色数据录入。

**VtM第五版规则人物卡数据录入：**
```
.vst 力量=0 敏捷=0 体质=0 魅力=0 操控=0 沉着=0 智力=0 机智=0 决心=0 HP=0 HPMax=0 意志力=0 意志力Max=0 人性=0 饥渴=1 运动=0 肉搏=0 手艺=0 驾驶=0 枪械=0 盗窃=0 白刃=0 潜行=0 生存=0 驯兽=0 礼仪=0 洞悉=0 威吓=0 领导=0 表演=0 说服=0 街头=0 欺瞒=0 学术=0 觉察=0 金融=0 调查=0 医疗=0 神秘=0 政治=0 科学=0 科技=0 支配术=0 血魔术=0 观占术=0
```
*律能类别可自行增加，未录入的默认为0。

**VtM20周年纪念版规则人物卡数据录入：**
```
.vst 力量=0 敏捷=0 耐力=0 魅力=0 操控=0 外貌=0 感知=0 智力=0 机智=0 意志力=0 意志力Max=0 人性/心路等级=0 血池=0 血池Max=0 警觉=0 运动=0 超感=0 格斗=0 理解=0 表达=0 胁迫=0 领导=0 黑街=0 掩饰=0 驯兽=0 手艺=0 驾驶=0 礼仪=0 枪械=0 盗窃=0 白刃=0 表演=0 潜行=0 生存=0 学术=0 电脑=0 金融=0 调查=0 法律=0 医学=0 神秘=0 政治=0 科学=0 科技=0 良知/坚信=0 自控/本能=0 勇气=0
```
*律能类别可自行增加，未录入的默认为0。

**录卡后相关指令**
- `.vst` 查看当前规则的角色卡
- `.vst 项目=值` 将项目值录入角色卡（或更新角色卡中已有的同名项目值）
- `.vst d项目` 删除角色卡中的指定项目
- `.vst d!!!` 删除角色卡

**录卡后检定**
- `.va属性+技能k难度` 成功录卡后，自动调用卡中的骰池和饥渴值进行检定，多个属性/技能之间以加号或减号连接，也可直接使用数字作为骰池加值。
- 例：`.va敏捷+白刃k4`；`.va敏捷+4k4`；`.va魅力+支配术-1`
- 多重检定：`.va 3#敏捷+白刃k4` (进行3次判定)

**其他**
- `.v5st` 无视当前规则设定，访问并操作V5角色卡
- `.v20st` 无视当前规则设定，访问并操作V20角色卡
- `.v5a` 无视当前规则设定，使用V5角色卡进行检定
- `.v20a` 无视当前规则设定，使用V20角色卡进行检定

# VtM 角色卡录入辅助工具 v_0.0.2

本工具专为上述插件设计，旨在简化 **SealDice (海豹骰)** 相关插件的角色卡录入流程。支持 V5 与 V20 双版本规则，并实现与 V5 自动 Excel 人物卡基本互通。

[点击此处直接使用](https://allshell.github.io/vtm-char-sheet/)

## 核心功能

**双规则支持**：完整适配 VtM V5 与 V20 核心属性、技能系统。

* **Excel 智能同步 (仅限 V5)**：
* **一键导入**：支持读取《吸血鬼：避世潜藏5版半自动人物卡1.6.xlsm》中的属性、技能及 5 组自定义血律项目。
* **一键导出**：将网页修改后的数据写回原 Excel 模板（目前该工具不读写原表的公式与宏，因此导出功能仅建议作为暂存使用）。

**指令自动生成**：根据填写内容自动生成 `.vst` 录卡指令，过滤 0 值，一键复制 。

**灵活自定义**：支持手动添加、删除律能或其他自定义属性项目 。

## 使用说明

### 1. 模式选择

* 在页面顶部切换 **V5** 或 **V20** 模式 。

* **注意**：Excel 导入/导出功能目前仅针对上述版本的 V5 自动卡进行了坐标适配。

### 2. Excel 数据同步 (V5)

* **导入**：点击“导入 Excel”并选择填写好的 `.xlsm` 文件，系统将自动填充标准属性、技能及最多 5 组自定义血律。
* **导出**：在网页修改数据后，点击“导出 Excel”，系统会将当前数值写回模板并生成新的文件（目前该工具不读写原表的公式与宏，因此导出功能仅建议作为暂存使用）。

### 3. 指令同步至 SealDice

* 填写或核对完数据后，点击底部的 **“生成录卡指令”** 。

* 点击 **“复制指令”**，将其发送至安装了 `vtm_1.8.5.js` 插件的 SealDice 窗口即可完成录卡 。

## Excel 坐标映射参考 (V5)

本工具默认适配的自定义槽位如下：

* **标准属性/技能**：已根据 1.6 版半自动人物卡进行坐标预设。
* **自定义血律槽位 1-5 (名称)**：K14, K21, K28, K35, K42。
* **自定义血律槽位 1-5 (等级)**：K16, K23, K30, K37, K44。

## 依赖项

* **前端处理**：SheetJS (xlsx.full.min.js)。

**骰子插件**：配套使用 `vtm.js` 以获得最佳的 `.va` 检定体验。
